# 0228_04 — 移除外层透明框架 & 缩减阴影（方案 B）

## 问题现状

当前窗口显示时，用户看到的视觉层次为：

1. **系统窗口层** — Tauri 配置 `transparent: true` + `decorations: false` + `shadow: true` → Windows 11 给无装饰透明窗口加 **1px 白边 + 圆角 + 系统阴影**。
2. **CSS 透明间距层** — `FlipCard.tsx` 外层 `p-4`（16px）在卡片与窗口边缘间形成一圈透明空白。
3. **双层玻璃卡片** — WorkArea / SettingsPanel 各自有外壳 + 内层，多层大面积 CSS 阴影。
4. **翻转阴影** — `FLIP_SHADOW` 最大 `0 35px 120px rgba(0,0,0,0.60)`。
5. **窗口尺寸** — `useAutoResizeWindow` 以 `height + verticalPadding(32)` 计算窗口高度；宽度固定 600px。卡片宽度用 vw 单位（`92vw` / `96vw`）。

**用户感受**：外层透明框架 + 多层大阴影令卡片"悬浮在隐形盒子里"。

---

## 底层原因分析

| 视觉问题 | 根因 | 位置 |
|---|---|---|
| 外层透明框架可见 | `shadow: true` → Win11 白边 + 系统阴影 | `tauri.conf.json` |
| 卡片四周大片空白 | FlipCard `p-4` = 16px | `FlipCard.tsx` L155 |
| CSS 阴影范围过大 | WorkArea/Settings 外壳 20px 70-80px blur | `WorkArea.tsx` / `SettingsPanel.tsx` |
| 翻转阴影过大 | `FLIP_SHADOW` max 35px 120px | `FlipCard.tsx` L32 |
| 窗口高度含 32px padding | `WINDOW_VERTICAL_PADDING = 32` | `App.tsx` L16 |

---

## 方案 B：极小透明间距 + 关闭系统阴影 + 缩减 CSS 阴影

**核心思路**：
- 关闭系统阴影（去掉 Win11 白边）
- 保留 **6px 透明间距** 作为 CSS 阴影的渲染空间（视觉上不可见）
- 大幅缩减所有 CSS 阴影（blur ≤ 阴影间距）
- 窗口宽度/高度计算适配新间距

---

## 预期的改动点

### 改动 1：关闭系统窗口阴影

**文件**: `src-tauri/tauri.conf.json`
- `"shadow": true` → `"shadow": false`

### 改动 2：缩减 FlipCard 间距 & 窗口尺寸适配

**文件**: `src/components/layout/FlipCard.tsx`
- 外层 `p-4`（16px）→ `p-1.5`（6px）

**文件**: `src/App.tsx`
- `WINDOW_VERTICAL_PADDING` 32 → 12（上下各 6px）
- 卡片宽度从 vw 改为固定 px：`w-[588px]` / `w-[588px]`（均撑满，600 − 12 = 588）

### 改动 3：缩减翻转动画阴影

**文件**: `src/components/layout/FlipCard.tsx`
- `FLIP_SHADOW` 整体缩减，max blur ≤ 6px offset + 20px blur

### 改动 4：缩减 WorkArea 双层阴影

**文件**: `src/components/zenreply/WorkArea.tsx`
- 外壳: `shadow-[0_20px_70px_...]` → `shadow-[0_2px_8px_...]`
- 内层: `0_20px_80px_...` → `0_4px_16px_...`

### 改动 5：缩减 SettingsPanel 双层阴影

**文件**: `src/components/settings/SettingsPanel.tsx`
- 同 WorkArea 同步缩减

---

## 预期效果

- 唤醒时**只看到玻璃卡片**，无可见边框/系统白边
- 卡片有适度的柔和 CSS 阴影作为深度提示，不被窗口裁切
- 窗口大小紧贴卡片（±6px），随卡片高度自适应变化
- 翻转动画阴影收敛但保留立体感

## 潜在风险

1. `shadow: false` 在 Win10 上行为待确认（Win10 无圆角，应无白边问题）
2. 6px 间距 = CSS 阴影最大可渲染距离，阴影 blur > 6px 的部分会被裁切（已将所有阴影控制在范围内）
3. FlipCard 翻转 `scale` 关键帧使卡片瞬间变大 ~0.8%，6px 间距足以容纳